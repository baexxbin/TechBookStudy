### 13장 테스트 피라미드

- 대중적인 분류체계인 **테스트 피라미드**

  - 단위 테스트
    - 소프트웨어를 구성하는 가장 작은 단위를 검증하는 테스트를 의미함.
    - 객체나 컴포넌트에 할당된 작은 책임하나가 예상대로 동작하는지 확인하는 테스트라고 할 수 있음.
  - 통합 테스트
    - 여러 컴포넌트나 객체가 협력하는 상황을 검증하는 테스트.
    - 통합 테스트는 독립적으로 만들었던 객체들이 상호작용하면서 생길 수 있는 상황을 검증.
    - 서로 다른 모듈이나 시스템 간의 인터페이스를 테스트하는 것이라 볼 수도 있음.
  - E2E 테스트(인수테스트)
    - 사용자의 관점에서 시스템이 어떻게 동작하는지 검증하는 테스트.
    - 사용자의 요구사항을 만족하는지 검증하는 테스트라고 할 수 있음.

- **단위 테스트가 제일 많아야 하고 그 다음으로 통합 테스트가 많아야 하고 그 다음으로 E2E 테스트가 많아야 함.**
  - 단위 테스트 80%, 통합 테스트 15%, E2E 테스트 5% 정도가 적절한 비율이라고 함.

#### 구글의 테스트 피라미드

- 위에서 말한 단위 테스트, 통합 테스트, E2E 테스트는 설명하기 모호함.
- 구글에서 쓰이는 테스트 피라미드 모델은 다음과 같음.
  - 대형 테스트 : 멀티 서버에서 동작하는 테스트를 의미.
  - 중형 테스트 : 단일 서버에서 동작하되, 멀티 프로세스, 멀티 스레드를 사용할 수 있는 테스트를 의미.
  - 소형 테스트 : 단일 서버, 단일 프로세스, 단일 스레드에서 동작하며 디스크 I/O, 블로킹 호출이 없는 테스트를 의미.

#### 테스트 분류 기준

- 테스트는 결정적이고 빠를 수록 좋음.
  - 결정적이어야 한다는 말은 같은 코드를 대상으로 실행하는 테스트는 항상 같은 응답을 해야한다는 의미.
  - 즉, 네트워크 환경 Disk I/O 처리 상태 등에 따라서 테스트 결과가 달라지면 안됨.
- 테스트에 H2를 사용한다는 것은 H2를 위한 **별도의 프로세스를 실행**한다는 의미임.
  - 따라서 H2 데이터베이스를 사용하는 테스트는 **중형 테스트**라고 할 수 있음.
