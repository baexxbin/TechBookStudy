### 12장 자동 테스트

- 인수 테스트는 시스템이 비즈니스 요구사항을 만족해서 소유권을 넘기기 전에 수행하는 테스트 단계를 뜻함.
- 시스템을 인수인계하기 전에 시스템이 비즈니스 요구사항과 일치하는지 마지막으로 검증하는 단계.
- 인수 테스트는 테스트 단계 중 가장 마지막에 수행하는 `단계`를 뜻함.
- 인수 테스트 과정에는 수동 테스트가 있을 수도 있고 자동 테스트가 있을 수도 있음.
- 수동 테스트의 단점
  - 인수 테스트 과정의 테스트를 대부분 수동으로 구성하면 작업 자들이 인수 테스트를 수행할 때 너무 많은 비용이 듬.
  - 테스트 절차를 사람이 직접 수행하고 눈으로 확인하는 데는 많은 시간과 노력이 들기 때문.
  - 사람이 테스트를 수행하기 때문에 실수할 수도 있고 버그 상황을 눈치채지 못하고 넘어갈 수 있음.
  - 한 번 만들어진 수동 테스트는 누적 됨. 👉 해당 기능이 없어지는 날까지 해야함.
- 자동 테스트를 해야 하는 이유
  - 테스트가 실패했다는 것은 개발 과정에서 의도하지 않은 버그가 만들어졌음을 의미.
  - 자동 테스트는 수동 테스트와는 다르게 개발자에게 좋은 의미로 누적. 👉 코드 변경을 할 때 용감하게 함.

#### Regression

- Regression
  - 시스템에서 정상적으로 제공하던 기능이 어떤 배포 시점을 기준으로 제대로 동작하지 않게 되는 상황.
  - 회귀 버그라고도 부름.
- 프로젝트 구조를 온전히 파악하기 전까지 자신감 있게 개발하지 못한다는 것은 어떤 숙련된 개발자가 와도 본인의 기량을 전부 발휘할 수 없음.
  - 기존 코드를 변경하거나 리팩터링 하는 경우 어떤 사이드 이펙트가 발생할지 모르기 때문.

#### 의도

- 아래와 같은 코드가 있다고 가정할 때 `userRepository.findById` 메서드의 존재 이유를 제대로 파악불가.
- 주석이나 메서드 명을 통해서 의도가 정확히 파악되지 않음.
  - user가 있는지 확인한다는 주석이나 `userRepository.assertExistence` 같은 이름으로 메서드명을 지었다면 이해하기 쉬웠을 것.
- 이 때, 테스트 코드가 작성되어 있다면 테스트 코드 그 자체나 테스트 코드 실패를 통해서 `userRepository.findById` 메셔드의 의도를 파악할 수 있고 존재해야 하는 코드인지 파악 가능.
- 그래서 테스트는 책임에 대한 **계약**이라고 할 수 있음.

```java filename="" copy showLineNumbers
public void doSomething(long userId) {
  userRepository.findById(userId);

  // 이하 생략
}
```

#### 레거시 코드

- 레거시 코드는 통상적으로 오래된 소프트웨어 시스템에 존재하는 코드를 의미함.
- 하지만 **마이클 c. 페더스**는 다음과 같이 얘기함.
  - "내게 레거시 코드란 테스트 코드가 없는 코드를 의미한다."
  - 이 정의에 따르면 레거시 코드는 테스트가 작성되있지 않아 변경하기 어려운 코드를 레거시라고 함.
  - 바로 어제 짠 코드도 테스트 코드가 없다면 레거시 코드가 될 수 있다는 것.
